<!-- Detect malware IP -->
<group name="malware_ips,">
  <!-- SSH block -->
  <rule id="100101" level="15">
    <if_sid>5715</if_sid>
    <list field="srcip" lookup="address_match_key">etc/lists/malware_ips</list>
    <description>Malicious IP $(srcip) detected sshd:SUCCESS</description>
  </rule>

  <rule id="100102" level="9">
    <if_sid>5716</if_sid>
    <list field="srcip" lookup="address_match_key">etc/lists/malware_ips</list>
    <description>Malicious IP $(srcip) detected sshd:FAILED</description>
  </rule>

<!-- Windows logging block -->
  <rule id="100003" level="15">
    <if_sid>60103</if_sid>
    <list field="win.eventdata.ipAddress" lookup="address_match_key">etc/lists/malware_ips</list>
    <description>Malicious IP $(win.eventdata.ipAddress) detected logon:SUCCESS</description>
  </rule>

  <rule id="100005" level="9">
    <if_sid>60104</if_sid>
    <list field="win.eventdata.ipAddress" lookup="address_match_key">etc/lists/malware_ips</list>
    <description>Malicious IP $(win.eventdata.ipAddress) detected logon:FAILED</description>
  </rule>

  <!-- WEB block -->
  <!-- For Linux host -->
  <rule id="100006" level="9">
    <if_group>web|attack|accesslog|syslog|nginx|postfix|spam</if_group>
    <list field="srcip" lookup="address_match_key">etc/lists/malware_ips</list>
    <description>Malicious IP connection $(srcip) detected</description>
  </rule>

  <!-- For Windows host -->
  <rule id="100007" level="9">
    <if_group>web|attack|windows|windows_security|authentication_failed</if_group>
    <list field="win.eventdata.ipAddress" lookup="address_match_key">etc/lists/malware_ips</list>
    <description>Malicious IP connection $(win.eventdata.ipAddress) detected</description>
  </rule>
</group>
